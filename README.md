# @yyberi/logger

A lightweight wrapper around [pino](https://www.npmjs.com/package/pino) for structured, level-based logging in both development and production environments.

## Installation

```bash
npm install @yyberi/logger pino pino-pretty
```

> **Note:** The production transport uses `pino/file` under the hood. Make sure you have `pino` v7+ installed.

## Features

* **Root & child loggers** keyed by service or module name
* **Automatic environment detection** (`NODE_ENV`) for console pretty-printing in development and file-based logging in production
* **Customizable log levels** via the `LogLevel` enum
* **ISO timestamps** in production logs

## Usage

```ts
import getLogger, { LogLevel } from '@yyberi/logger';

// Root logger (defaults to service name from package.json)
const logger = getLogger();

// Set global log level
logger.setLogLevel(LogLevel.INFO);

logger.info('Application started');

// Create a module-specific child logger
const authLogger = logger.child({ name: 'auth' });
authLogger.debug('Checking user credentials');
```

### Configuration

* `NODE_ENV=production`

  * Logs to `logs/app.log` with level `info` and above
  * Outputs JSON with `timestamp`, `env`, `version`, and `service` fields

* any other `NODE_ENV`

  * Logs to console with colors and single-line pretty printing
  * Ignores `service` and `module` fields in output (shown in prefix instead)

### API

| Method                     | Description                         |
| -------------------------- | ----------------------------------- |
| `getLogger(serviceName?)`  | Get or create a root logger         |
| `logger.child(bindings)`   | Create a child logger with metadata |
| `logger.setLogLevel(...)`  | Dynamically adjust log level        |
| `logger.{fatal,error,...}` | Log at the specified level          |

### Caveats & Tips

* Ensure the `logs` directory exists or grant write permissionsâ€”`mkdir: true` will create it automatically if needed.
* The production setup writes logs asynchronously; data may be buffered if the process exits suddenly.
* Timestamp formatting overrides the default millisecond output; logs include ISO strings.
* Verify that your `package.json` version field is set to expose the correct `version` in metadata.

---

*Generated by @yyberi/logger*
